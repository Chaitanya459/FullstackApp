IFS=$'\n'
# regex supports mono-repos with a package.json at root-level and at package-level
PACKAGE_LOCK_REGEX="(^packages\/.*\/package-lock\.json)|(^package-lock\.json)"
# extract all paths to package-lock.json files
PACKAGES=("$(git diff --name-only HEAD@{1} HEAD | grep -E "$PACKAGE_LOCK_REGEX")")

echo "Remember to run 'npm run reveal-secrets' after pulling changes from the remote repository."

if [[ ${PACKAGES[@]} ]]; then
  for package in $PACKAGES; do
    echo "ðŸ“¦ $package was changed. Running npm install to update your dependencies..."
  done

  npm install
fi
